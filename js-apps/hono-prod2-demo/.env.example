# ==============================================
# 1. 源变量 (Raw Sources)
# 约定：留空 = 必须从 AWS Parameter Store 拉取
# 行为：psenv 发现为空 -> 去 AWS 找 -> 找不到报错
# ==============================================

# 数据库凭证 (AWS 存)
COMMON_POSTGRES_APP_USER=
COMMON_POSTGRES_APP_USER_PASSWORD=



# Redis 凭证 (AWS 存)
COMMON_REDIS_PASSWORD=

# ==============================================
# 2. 计算变量 (Computed Logic)
# 约定：使用 ${} 语法进行模板渲染
# 行为：psenv 只进行内存替换，不去 AWS 找这些 Key
# ==============================================

# [Host Logic]
# Preview: 脚本注入 "postgres" -> 使用 "postgres"
# Local:   脚本无注入 -> 使用默认值 "localhost"
# Prod:    脚本无注入 -> 去 AWS 找 CTX_PG_HOST 或使用 AWS 配置的值
DB_HOST=${CTX_PG_HOST:-localhost}
REDIS_HOST=${CTX_REDIS_HOST:-localhost}

# [Database Name Logic]
# Preview: hono_prod2_demo + _feat_auth (如 hono_prod2_demo_feat_auth)
# Local:   hono_prod2_demo + (空) = hono_prod2_demo
# Prod:    hono_prod2_demo + (空) = hono_prod2_demo
POSTGRES_DB=hono_prod2_demo${CTX_DB_SUFFIX:-}

# [Public URL Logic]
# 使用目录名作为子域名，双中划线分隔
# Local:   https://hono-prod2-demo.local.owenyoung.com
# Preview: https://hono-prod2-demo--feat-test.preview.owenyoung.com
# Prod:    https://hono-prod2-demo.owenyoung.com
PUBLIC_URL=https://hono-prod2-demo${CTX_DNS_SUFFIX:-}.${CTX_ROOT_DOMAIN:-local.owenyoung.com}

# [Deploy Target]
# 指定部署到哪台 prod 服务器（只在 prod 环境生效）
DEPLOY_SERVER=prod2

# [Connection Strings]
# 最终组装，只引用上面的变量
DATABASE_URL=postgresql://${COMMON_POSTGRES_APP_USER}:${COMMON_POSTGRES_APP_USER_PASSWORD}@${DB_HOST}:5432/${POSTGRES_DB}
REDIS_URL=redis://default:${COMMON_REDIS_PASSWORD}@${REDIS_HOST}:6379
